<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>Алгоритм</TITLE>
<META content="text/html; charset=Windows-1252" http-equiv="Content-Type">
<LINK rel="stylesheet" type="text/css" href="mainstyle.css"></HEAD>
<BODY id=bodyID class=dtBODY>
<DIV id=nsbanner>
<DIV id=bannerrow1>
<TABLE class=bannerparthead cellSpacing=0>
  <TBODY>
  <TR id=hdr>
    <TD class=runninghead></TD>
    <TD class=product></TD></TR></TBODY></TABLE></DIV>
<DIV id=TitleRow>
<H1 class=dtH1>Алгоритм программы</H1></DIV></DIV>
<DIV id=nstext>
<H4 class=dtH4>Поставленная задача:</H4>
<div style="margin-left: 20px;">
	<li>Программа должна создавать исполняемый файл <B>EXE</B>, который запускает указанный стартовый сценарий односкрипта без показа окна терминала.</li>
	<li>Файл <B>EXE</B> должен интегрировать в себя стартовый сценарий.</li>
	<li>Должна быть возможность извлечь стартовый сценарий из <B>EXE</B> файла.</li>
	<li>При просмотре свойств <B>EXE</B> файла должна быть видна информация о версии продукта, авторских правах и другая информация.</li>
</div>
<H4 class=dtH4>Как это сделано:</H4>
<P>Был создан проект на c# с типом выходных данных "Приложение Windows" состоящий из одного файла <B>Program.cs</B>. 
С помощью класса <B>Microsoft.CSharp.CSharpCodeProvider</B> из набора файлов компилируется <B>EXE</B> файл.</P>
<P>В наборе файлов есть <B>AssemblyInfo.cs</B> в котором мы задаем информацию для отображения в свойствах <B>EXE</B> файла и 
файл для сохранения текста сценария.</P>
<P>Необходимые данные программа возьмет из отредактированного Вами файла <B>settings.cfg</B>. При его отсутствии он будет создан по шаблону при первом запуске. 
Все сообщения программа будет писать в файл <B>error.log</B>.</P>
<P>Версия односкрипта будет соответствовать версии приложенных библиотек <B>ScriptEngine.dll</B>, <B>ScriptEngine.HostedScript.dll</B>, <B>OneScript.Language.dll</B>, <B>Newtonsoft.Json.dll</B>.
Сам файл <B>oscript.exe</B> как таковой не используется.</P>
<P>При успешной компиляции в каталог будут записаны файлы <B>oscript.cfg</B> и <B>.\lib\package-loader.os</B>. 
В каталог <B>.\lib</B> запишите нужные Вам пакеты односкрипта (в большинстве случаев нет необходимости).</P>
<br>
<P>Пишите Ваши предложения по расширению функционала данной разработки.</P>
<P></P>
</DIV></BODY></HTML>